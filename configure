#!/bin/sh

sysname=$1

uname=`uname -s`
machine=`uname -m`

if [ "$sysname" = "" ]; then
  case $uname in
    ULTRIX)
      sysname=ultrix;;
    BSD/OS)
      sysname=bsdos;;
    OSF1)
      if [ $machine = 'alpha' ]; then
        sysname=alphaosf
      fi;;
    Linux)
      sysname=linux;;
    SunOS)
      case `uname -r` in
        4*) sysname=sunos4;;
        5*) sysname=sunos5;;
      esac;;
    NetBSD)
      sysname=netbsd;;
    FreeBSD)
      sysname=freebsd;;
    hpux)
      sysname=hpux;;
  esac
fi

if [ "$sysname" = "" ]; then
  echo
  echo "Unknown system.   If this is an SCO system running ODT 3.0 or"
  echo "higher, type \`\`./configure sco''.   Otherwise, this is a"
  echo "configuration that isn't supported or hasn't been tested."
  echo
  echo "Supported configurations are:"
  echo "   ultrix	ULTRIX 4.2A or higher"
  echo "   bsdos	BSDI BSD/OS 2.1"
  echo "   alphaosf	DEC Alpha OSF/1"
  echo "   linux	Linux"
  echo "   sunos4	Sunos 4.1.4 (earlier releases may work)"
  echo "   sunos5	SunOS 5.5 (Solaris 2.5) (earlier 2.x releases may work)"
  echo "   netbsd	NetBSD 1.1 or higher"
  echo "   freebsd	FreeBSD"
  echo "   hpux		HP-UX"
  exit 1;
fi

if [ \( $sysname = "bsdos" -o $sysname = "netbsd" -o $sysname = "freebsd" \) \
	-a \( ! -f /var/db/dhcpd.leases \) -a \( -f /etc/dhcpd.leases \) ];
  then
    echo
    echo "                   !!!WARNING!!!"
    echo
    echo DHCPD is now storing the DHCP lease database in /var/db
    echo instead of /etc.   Before you start using this new version
    echo of dhcpd, you must move your dhcpd.leases file from /etc
    echo to /var/db!
    echo
    echo "                   !!!WARNING!!!"
    echo
fi

echo "System Type: $sysname"

sed -e "/^##\+\+${sysname}\+\+/,/^##--${sysname}--/s/^#//" \
		<Makefile.dist >Makefile

exit 0
